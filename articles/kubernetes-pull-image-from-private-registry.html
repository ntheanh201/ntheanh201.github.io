<!doctype html>
<html>
  <head>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico" />
    <script async src="https://cdn.splitbee.io/sb.js"></script>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="referrer" content="always" />
    <link
      rel="alternate"
      type="application/atom+xml"
      title="RSS 2.0"
      href="/atom.xml"
    />
    <link rel="canonical" href="https://ntheanh201.id.vn/articles/kubernetes-pull-image-from-private-registry.html" />
    

    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@ntheanh201" />
    <meta name="twitter:title" content="Kubernetes pull image from private registry" />
    
    <meta name="twitter:creator" content="@ntheanh201" />
    
    <meta name="twitter:image" content="https://ntheanh201.id.vn/img/03a52ae66fd3a4fa30520fc7ee8a61354dd0fcd9.jpg" />
     

    
    <meta property="og:title" content="Kubernetes pull image from private registry" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://ntheanh201.id.vn/articles/kubernetes-pull-image-from-private-registry.html" />
     
    <meta property="og:image" content="https://ntheanh201.id.vn/img/03a52ae66fd3a4fa30520fc7ee8a61354dd0fcd9.jpg" />
    

    <title>Kubernetes pull image from private registry</title>

    <link href="/css/main.css" rel="stylesheet" />
    <link href="/css/style.css" rel="stylesheet" />
    <script type="text/javascript">
      function showcontact() {
        var el = document.getElementById("contact-form");
        el.style.display = "block";
        el = document.getElementById("contact-page-url");
        var uri = window.location.href;
        uri = uri.replace("#", "");
        el.value = uri;
        el = document.getElementById("msg-for-chris");
        el.focus();
      }

      function hidecontact() {
        var el = document.getElementById("contact-form");
        el.style.display = "none";
      }

      function isWindows() {
        return (
          window.navigator &&
          window.navigator.platform &&
          window.navigator.platform.indexOf("Win") >= 0
        );
      }

      function maybeShowAd() {
        
        

      }

      function onLoaded() {
        maybeShowAd();
      }

      document.addEventListener("DOMContentLoaded", onLoaded);
    </script>
    <script type="text/javascript">
      var galleries = {}; 
      function buildGalleriesInfo() {
        var els = document.getElementsByTagName("img");
        var n = els.length;
        for (var i = 0; i < n; i++) {
          var el = els[i];
          var id = el.id;
          if (!id.startsWith("id-thumb-img-")) {
            continue;
          }
          id = id.replace("id-thumb-img-", "");
          
          var parts = id.split("-");
          var galleryID = parseInt(parts[0]);
          var imageNo = parseInt(parts[1]);
          var galleryInfo = galleries[galleryID] || {};
          galleryInfo[imageNo] = el.src;
          galleries[galleryID] = galleryInfo;
        }
        var ids = Object.keys(galleries);
        for (var gid of ids) {
          var galleryInfo = galleries[gid];
          galleryInfo.nImages = Object.keys(galleryInfo).length;
          galleryInfo.currImageNo = 0;
          changeShot(gid, 0);
        }
      }

      function changeShot(galleryID, imgNo) {
        var gi = galleries[galleryID];
        gi.currImageNo = imgNo;
        var url = gi[imgNo];
        var id = "id-gallery-" + galleryID;
        var el = document.getElementById(id);
        el.src = url;
        
        for (var i = 0; i < gi.nImages; i++) {
          id = "id-thumb-" + galleryID + "-" + i;
          el = document.getElementById(id);
          if (i == imgNo) {
            el.classList.add("selected-img");
          } else {
            el.classList.remove("selected-img");
          }
        }
        var els = document.getElementsByTagName("div");
        var nEls = els.length;
      }

      function imgNext(galleryID) {
        var gi = galleries[galleryID];
        var nImages = gi.nImages;
        var imgNo = gi.currImageNo;
        imgNo = (imgNo + 1) % nImages;
        changeShot(galleryID, imgNo);
      }

      function imgPrev(galleryID) {
        var gi = galleries[galleryID];
        var imgNo = gi.currImageNo - 1;
        if (imgNo < 0) {
          imgNo = gi.nImages - 1;
        }
        changeShot(galleryID, imgNo);
      }

      document.addEventListener("DOMContentLoaded", buildGalleriesInfo);
    </script>
  </head>

  <body>
    <nav class="site-header">
    <div class="site-header-inner">
        <a href="/" class="site-header-brand">ntheanh201</a>
        <div class="site-header-nav">
            <a href="/archives.html" class="nav-link">ARTICLES</a>
            <a href="https://github.com/ntheanh201" class="nav-link" target="_blank">GITHUB</a>
            <a href="https://linkedin.com/in/ntheanh201" class="nav-link" target="_blank">LINKEDIN</a>
        </div>
    </div>
</nav>

    <div id="content" class="article-page">
      <div class="article-hero">
        <h1 class="article-title">Kubernetes pull image from private registry</h1>
      </div>

      
      <div class="article-cover">
        <img src="/img/03a52ae66fd3a4fa30520fc7ee8a61354dd0fcd9.jpg" alt="Kubernetes pull image from private registry" class="article-cover-img" />
      </div>
      

      <div class="article-layout">
        
        
        <div class="article-sidebar-left">
          <div class="article-sidebar-sticky">
            <div class="article-sidebar-block">
              <div class="article-sidebar-type">Article</div>
              <div class="article-sidebar-title">Kubernetes pull image from private registry</div>
              <a href="/articles/kubernetes-pull-image-from-private-registry.html" class="article-sidebar-permalink">üîó</a>
            </div>

            <div class="article-sidebar-block">
              <table class="article-sidebar-table">
                <tr>
                  <td>
                    <div class="article-sidebar-cell-label">Published</div>
                    <div class="article-sidebar-cell-value">
                      Aug 18, 2022
                    </div>
                  </td>
                  
                  <td>
                    <div class="article-sidebar-cell-label">Tags</div>
                    <div class="article-sidebar-cell-value">
                      <a
                        href="/tag/kubernetes.html"
                        class="article-sidebar-tag-link"
                        >kubernetes</a
                      >
                    </div>
                  </td>
                  
                </tr>
              </table>
            </div>

            <div class="article-sidebar-block">
              <div class="article-sidebar-social">
                <em>I'm on Facebook/X at</em>
                <br /><a href="https://facebook.com/ntheanh201"
                  ><strong>@ntheanh201</strong></a
                >.
              </div>
            </div>
          </div>
        </div>
        

        
        <div class="article-center">
          <div class="article-content"><p></p>
<div class="notion-page" id="fe00a2ac-e8f8-4fce-bf59-b1c18379f646">
  <h2 id="heading-1-gioi-thieu" class="">1. Gi·ªõi thi·ªáu
  </h2>
  <p id="1e7a6f80-71d9-804b-aaf9-ee9e60451ee7" class=" notion-text-block">Trong th·ª±c t·∫ø, nhi·ªÅu doanh nghi·ªáp s·ª≠ d·ª•ng private registry ƒë·ªÉ l∆∞u tr·ªØ Docker images v√¨ l√Ω do b·∫£o m·∫≠t. B√†i vi·∫øt n√†y s·∫Ω h∆∞·ªõng d·∫´n c√°ch c·∫•u h√¨nh Kubernetes ƒë·ªÉ pull images t·ª´ private registry.
  </p>
  <h2 id="heading-2-cac-buoc-thuc-hien" class="">2. C√°c b∆∞·ªõc th·ª±c hi·ªán
  </h2>
  <h3 id="heading-21-tao-docker-registry-secret" class="">2.1. T·∫°o Docker registry secret
  </h3>
  <p id="1e7a6f80-71d9-80ef-8935-c22dbcee945d" class=" notion-text-block">ƒê·∫ßu ti√™n, c·∫ßn t·∫°o m·ªôt secret ch·ª©a th√¥ng tin ƒëƒÉng nh·∫≠p v√†o registry:
  </p><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">kubectl create secret docker-registry regcred <span class="se">\\</span>
</span></span><span class="line"><span class="cl">  --docker-server<span class="o">=</span>&lt;your-registry-server&gt; <span class="se">\\</span>
</span></span><span class="line"><span class="cl">  --docker-username<span class="o">=</span>&lt;your-name&gt; <span class="se">\\</span>
</span></span><span class="line"><span class="cl">  --docker-password<span class="o">=</span>&lt;your-password&gt; <span class="se">\\</span>
</span></span><span class="line"><span class="cl">  --docker-email<span class="o">=</span>&lt;your-email&gt;</span></span></code></pre>
  <p id="1e7a6f80-71d9-8026-a3f5-e187d08f642b" class=" notion-text-block">Trong ƒë√≥:
  </p>
  <ul id="1e7a6f80-71d9-80ab-9c90-e1c8fa29a7f4" class="bulleted-list">
    <li><code>regcred</code>: t√™n c·ªßa secret
    </li>
    <li><code>-docker-server</code>: URL c·ªßa registry (v√≠ d·ª•: <a href="https://index.docker.io/v1/">https://index.docker.io/v1/</a> cho DockerHub)
    </li>
    <li><code>-docker-username</code>: username ƒëƒÉng nh·∫≠p registry
    </li>
    <li><code>-docker-password</code>: password ƒëƒÉng nh·∫≠p registry
    </li>
    <li><code>-docker-email</code>: email ƒëƒÉng k√Ω v·ªõi registry
    </li>
  </ul>
  <h3 id="heading-22-su-dung-secret-trong-pod-configuration" class="">2.2. S·ª≠ d·ª•ng secret trong Pod configuration
  </h3>
  <p id="1e7a6f80-71d9-8005-b13c-d12ed674cf35" class=" notion-text-block">Sau khi t·∫°o secret, th√™m tr∆∞·ªùng <code>imagePullSecrets</code> v√†o Pod specification:
  </p><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">private-pod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">private-container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">private-registry.io/apps/internal-app:v1.2.3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">imagePullSecrets</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">regcred</span></span></span></code></pre>
  <h2 id="heading-3-kiem-tra-cau-hinh" class="">3. Ki·ªÉm tra c·∫•u h√¨nh
  </h2>
  <p id="1e7a6f80-71d9-80c3-a524-e6ac2e9f5669" class=" notion-text-block">C√≥ th·ªÉ ki·ªÉm tra secret ƒë√£ t·∫°o b·∫±ng l·ªánh:
  </p><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">kubectl get secret regcred -oyaml</span></span></code></pre>
  <h2 id="heading-4-mot-so-luu-y-quan-trong" class="">4. M·ªôt s·ªë l∆∞u √Ω quan tr·ªçng
  </h2>
  <ul id="1e7a6f80-71d9-80dc-9148-dad8fab68703" class="bulleted-list">
    <li>Secret ph·∫£i ƒë∆∞·ª£c t·∫°o trong c√πng namespace v·ªõi Pod
    </li>
    <li>N·∫øu s·ª≠ d·ª•ng nhi·ªÅu clusters, c·∫ßn t·∫°o secret tr√™n t·ª´ng cluster ri√™ng bi·ªát
    </li>
    <li>C√≥ th·ªÉ s·ª≠ d·ª•ng m·ªôt secret cho nhi·ªÅu pods
    </li>
    <li>N√™n s·ª≠ d·ª•ng Kubernetes Secrets Management ƒë·ªÉ b·∫£o m·∫≠t th√¥ng tin ƒëƒÉng nh·∫≠p
    </li>
  </ul>
  <h2 id="heading-5-xu-ly-loi-thuong-gap" class="">5. X·ª≠ l√Ω l·ªói th∆∞·ªùng g·∫∑p
  </h2>
  <p id="1e7a6f80-71d9-8054-a7c0-ecb5c963bbe7" class=" notion-text-block">M·ªôt s·ªë l·ªói ph·ªï bi·∫øn khi pull image t·ª´ private registry:
  </p>
  <ul id="1e7a6f80-71d9-80b6-b079-dfb91972b96b" class="bulleted-list">
    <li><code>ImagePullBackOff</code>: Ki·ªÉm tra l·∫°i th√¥ng tin ƒëƒÉng nh·∫≠p trong secret
    </li>
    <li><code>ErrImagePull</code>: X√°c nh·∫≠n l·∫°i URL c·ªßa registry v√† t√™n image
    </li>
    <li>Timeout: Ki·ªÉm tra k·∫øt n·ªëi m·∫°ng v√† firewall rules
    </li>
  </ul>
  <p id="1e7a6f80-71d9-80bc-816a-f8519f89887b" class=" notion-text-block">ƒê·ªÉ debug, c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh:
  </p><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">kubectl describe pod &lt;pod-name&gt;</span></span></code></pre>
  <h2 id="heading-6-best-practices" class="">6. Best Practices
  </h2>
  <ul id="1e7a6f80-71d9-80b0-8078-f420a6478e2a" class="bulleted-list">
    <li>S·ª≠ d·ª•ng namespace ri√™ng cho t·ª´ng m√¥i tr∆∞·ªùng (development, staging, production)
    </li>
    <li>ƒê·ªãnh k·ª≥ rotate credentials c·ªßa registry
    </li>
    <li>S·ª≠ d·ª•ng RBAC ƒë·ªÉ ki·ªÉm so√°t quy·ªÅn truy c·∫≠p v√†o secrets
    </li>
    <li>Backup c√°c secret configurations
    </li>
  </ul>
  <p id="1e7a6f80-71d9-8092-9304-e0db14309498" class=" notion-text-block">
  </p>
  <p id="dd5d3151-bf59-4c17-831d-cf8033486513" class=" notion-text-block">Source: <a href="https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/">https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/</a>
  </p>
</div></div>
        </div>

        
        
        <div class="toc-container">
          <div class="toc-sticky">
            <div class="article-sidebar-type">Table of contents</div>
            <div class="table-of-contents">
<h2>Table of Contents</h2>
<ul>
<li>
<a href="#heading-1-gioi-thieu">1. Gi·ªõi thi·ªáu</a>
</li>
<li>
<a href="#heading-2-cac-buoc-thuc-hien">2. C√°c b∆∞·ªõc th·ª±c hi·ªán</a>
<ul>
<li>
<a href="#heading-21-tao-docker-registry-secret">2.1. T·∫°o Docker registry secret</a>
</li>
<li>
<a href="#heading-22-su-dung-secret-trong-pod-configuration">2.2. S·ª≠ d·ª•ng secret trong Pod configuration</a>
</li>
</ul>
</li>
<li>
<a href="#heading-3-kiem-tra-cau-hinh">3. Ki·ªÉm tra c·∫•u h√¨nh</a>
</li>
<li>
<a href="#heading-4-mot-so-luu-y-quan-trong">4. M·ªôt s·ªë l∆∞u √Ω quan tr·ªçng</a>
</li>
<li>
<a href="#heading-5-xu-ly-loi-thuong-gap">5. X·ª≠ l√Ω l·ªói th∆∞·ªùng g·∫∑p</a>
</li>
<li>
<a href="#heading-6-best-practices">6. Best Practices</a>
</li>
</ul>
</div>

          </div>
        </div>
        
      </div>

      <div class="article-footer">
        
        <em>
          <a href="https://facebook.com/ntheanh201"> @ntheanh201</a>
        </em>
        
      </div>
    </div>

    

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        
        const tocLinks = document.querySelectorAll(".table-of-contents a");

        
        tocLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();

            
            const targetId = this.getAttribute("href").substring(1);
            const targetElement = document.getElementById(targetId);

            if (targetElement) {
              
              targetElement.scrollIntoView({
                behavior: "smooth",
                block: "start",
              });

              
              history.pushState(null, null, "#" + targetId);
            }
          });
        });

        
        if (window.location.hash) {
          const targetId = window.location.hash.substring(1);
          const targetElement = document.getElementById(targetId);

          if (targetElement) {
            setTimeout(() => {
              targetElement.scrollIntoView({
                behavior: "smooth",
                block: "start",
              });
            }, 300);
          }
        }
      });
    </script>
  </body>
</html>
